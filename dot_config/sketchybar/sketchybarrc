#!/usr/bin/env bash

# Sketchybar configuration with Nerd Font icons
# This is a minimal configuration for macOS

# Check if sketchybar is installed
if ! command -v sketchybar >/dev/null 2>&1; then
    echo "Sketchybar not installed. Install with: brew install FelixKratz/formulae/sketchybar"
    exit 1
fi

# Bar appearance
sketchybar --bar height=32 \
                 blur_radius=30 \
                 position=top \
                 sticky=off \
                 padding_left=10 \
                 padding_right=10 \
                 color=0x15ffffff

# Default values
sketchybar --default icon.font="FiraCode Nerd Font:Bold:16.0" \
                     icon.color=0xffffffff \
                     label.font="FiraCode Nerd Font:Bold:14.0" \
                     label.color=0xffffffff \
                     padding_left=5 \
                     padding_right=5 \
                     label.padding_left=4 \
                     label.padding_right=4 \
                     icon.padding_left=4 \
                     icon.padding_right=4

# -- Left Side Items --
# Spaces
SPACE_ICONS=("1" "2" "3" "4" "5" "6" "7" "8" "9" "10")

for i in "${!SPACE_ICONS[@]}"
do
  sid=$(($i+1))
  sketchybar --add space space.$sid left \
             --set space.$sid space=$sid \
                              icon=${SPACE_ICONS[i]} \
                              background.color=0x44ffffff \
                              background.corner_radius=5 \
                              background.height=20 \
                              background.drawing=off \
                              label.drawing=off \
                              script="$HOME/.config/sketchybar/plugins/space.sh" \
                              click_script="yabai -m space --focus $sid"
done

# Window title
sketchybar --add item window_title left \
           --set window_title script="$HOME/.config/sketchybar/plugins/window_title.sh" \
                              icon.drawing=off \
           --subscribe window_title front_app_switched

# -- Right Side Items --
# Clock
sketchybar --add item clock right \
           --set clock update_freq=10 \
                       icon= \
                       script="$HOME/.config/sketchybar/plugins/clock.sh"

# Battery
sketchybar --add item battery right \
           --set battery script="$HOME/.config/sketchybar/plugins/battery.sh" \
                         update_freq=120 \
           --subscribe battery system_woke power_source_change

# CPU
sketchybar --add item cpu right \
           --set cpu script="$HOME/.config/sketchybar/plugins/cpu.sh" \
                     update_freq=2 \
                     icon=󰻠

# Memory
sketchybar --add item memory right \
           --set memory script="$HOME/.config/sketchybar/plugins/memory.sh" \
                        update_freq=5 \
                        icon=󰍛

# Network
sketchybar --add item network right \
           --set network script="$HOME/.config/sketchybar/plugins/network.sh" \
                         update_freq=5 \
                         icon=󰖩

# Volume
sketchybar --add item volume right \
           --set volume script="$HOME/.config/sketchybar/plugins/volume.sh" \
                        icon=󰕾 \
           --subscribe volume volume_change

# Initializing the sketchybar
sketchybar --update