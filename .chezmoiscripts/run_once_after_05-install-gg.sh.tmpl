#!/bin/bash

set -eufo pipefail

echo "Installing gg (git aliases)..."

# Check if gg is already installed
if command -v gg >/dev/null 2>&1; then
    echo "gg is already installed at: $(which gg)"
    echo "Version: $(gg --version 2>/dev/null || echo 'version unknown')"
else
    echo "Installing gg from GitHub..."

    # Create ~/.local/bin if it doesn't exist
    mkdir -p "$HOME/.local/bin"

    # Install gg using the official installation script from GitHub
    if curl -fsSL https://github.com/csi-lk/gg/raw/master/install.sh | bash; then
        echo "✓ gg installed successfully!"

        # Ensure ~/.local/bin is in PATH for current session
        export PATH="$HOME/.local/bin:$PATH"

        # Verify installation
        if command -v gg >/dev/null 2>&1; then
            echo "✓ gg is available at: $(which gg)"
            echo "  Version: $(gg --version 2>/dev/null || echo 'installed')"
        else
            echo "⚠ gg was installed but not found in PATH"
            echo "  Add ~/.local/bin to your PATH or restart your shell"
        fi
    else
        echo "✗ Failed to install gg"
        echo "  You can try manually: curl -fsSL https://github.com/csi-lk/gg/raw/master/install.sh | bash"
    fi
fi

echo "gg installation process complete!"